---
- name: Bootstrap environment
  hosts: localhost
  connection: local

  pre_tasks:
    - name: Set variables
      set_fact:
        config_user: "Karma"
      tags: always

    - name: Update apt cache
      apt:
        update_cache: yes
      when: ansible_os_family == ['Debian', 'Ubuntu', 'Raspbian', 'Kali']
      tags: always

    - name: Update Homebrew
      homebrew:
        state: latest
      when: ansible_os_family == 'Darwin'
      tags: always

    - name: Display Specific Ansible Facts
      debug:
        msg:
          - "OS Family: {{ ansible_facts['os_family'] }}"
          - "Distribution: {{ansible_facts['distribution']}}"
          - "User ID: {{ ansible_facts['user_id'] }}"
          - "Shell: {{ ansible_facts['user_shell'] }}"
      tags: always

  tasks:
    - name: ZSH
      tags: always
      import_tasks: tasks/zsh.yml

    - name: Neovim
      tags: always
      import_tasks: tasks/nvim.yml

    - name: CTF
      tags: never
      import_tasks: tasks/ctf.yml